<TestScript xmlns="http://hl7.org/fhir">
    <modifierExtension url="urn:module">
        <extension url="urn:variable-in">
            <valueString  value="manifestMasterIdentifier"/>
        </extension>
        <extension url="urn:variable-in">
            <valueString  value="referenceMasterIdentifier"/>
        </extension>
    </modifierExtension>

    <url value=""/>
    <name value="NoUpdateOneDoc"/>
    <status value="active"/>

    <variable>
      <name value="manifestPatientReference"/>
      <expression value="Bundle.entry.resource.where(is(FHIR.DocumentManifest)).subject.reference"/>
      <sourceId value="request"/>
    </variable>

    <test>
      <description value="Verify no updates to server."/>
      <action>
        <operation>
				  <description value="for DocumentManifest."/>
				  <type>
					  <code value="search"/>
				  </type>
				  <resource value="DocumentManifest"/> 
				  <contentType value="json"/>
				  <params value="?identifier=${manifestMasterIdentifier}"/> 
				  <responseId value="manifest-search"/>
			  </operation>
      </action>
      <action>
        <assert>
          <description value="Returns 200."/>
          <sourceId value="manifest-search"/>
          <response value="okay"/>
          <warningOnly value="false"/>
        </assert>
      </action>
      <action>
        <assert>
          <description value="No manifest returned."/>
          <compareToSourceId value="manifest-search"/>
          <compareToSourceExpression value="Bundle.total = 0"/>
          <warningOnly value="false"/>
        </assert>
      </action>
      <action>
        <operation>
				  <description value="for DocumentReference."/>
				  <type>
					  <code value="search"/>
				  </type>
				  <resource value="DocumentReference"/> 
				  <contentType value="json"/>
				  <params value="?identifier=${referenceMasterIdentifier}"/> 
				  <responseId value="reference-search"/>
			  </operation>
      </action>
      <action>
        <assert>
          <description value="Returns 200."/>
          <sourceId value="reference-search"/>
          <response value="okay"/>
          <warningOnly value="false"/>
        </assert>
      </action>
      <action>
        <assert>
          <description value="No DocumentReference returned."/>
          <compareToSourceId value="reference-search"/>
          <compareToSourceExpression value="Bundle.total = 0"/>
          <warningOnly value="false"/>
        </assert>
      </action>
    </test>
</TestScript>
